<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
  <link href="../css/battle.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="../js/changePage.js"></script>
  <script src="../js/battle.js"></script>
  <title>Do battle - 배틀</title>
</head>
<body>

<div id="real-top">
  <div id="battle-top">
    <div><img src="/image/arrow.svg" onclick = "changePage('../doingBattleList')"></div>
    <div id="write">배틀 상세보기</div>
    <div id="nothing"></div>
  </div>

  <div id="battle-detail">
    <div>
      <div id="detail-text">
        <span id="date">xx.xx~xx.xx<br></span>
        <span th:text="${battleName}" id="name">배틀 이름</span>
      </div>
      <div><img src="/image/small-fire.svg"></div>
    </div>
    <div><img src="/image/calendar.svg" onclick="goToBattlePage(this)"></div>
  </div>

  <div id="battle-progress">
    <div id="me">
      <div class="progress">
        <div class="first">60%</div>
        <img src="/image/progress-face-1.svg">
      </div>
      <p th:text="${currentUser.username}">김배틀</p>
    </div>

    <div id="vs">vs</div>

    <div id="other">
      <p th:text="${partnerUsernames}">박상대</p>  <!--username-->
      <div class="progress">
        <div class="first">26%</div>
        <img src="/image/progress-face-2.svg">
      </div>
    </div>
  </div>

  <div id="text">김배틀님이 34% 차이로<br>앞서가고 있어요!</div>
</div>

<div id="battle-bottom">
  <div id="todo-main">
    <div>TO-DO</div>
    <img onclick="todoClick()" src="/image/todo-fire-make.svg" style="cursor:pointer;">
  </div>

  <form id="3" th:action="@{'/battle/' + ${battleCode} + '/saveTodoData'}" method="post">
    <div class="todo-list">오늘의 todo리스트입니다.</div>
    <input type="submit" class="fire-button" value="notDone">
    <input type="hidden" name="todoDataValue" id="todoDataValue" value="내용">
    <input type="hidden" name="value" id="value" value="done">
    <!-- 추가한 부분 -->
    <h2>Todo List</h2>
    <ul>
      <li th:each="todoData : ${todoDataList}" th:text="${todoData.todoDataValue}"></li>
    </ul>
  </form>

</div>

<script th:inline="javascript">
    /*<![CDATA[*/
    let start = /*[[${startDate}]]*/;
    var splitStart = start.split('-');
    let startDate = splitStart[1] + '.' + splitStart[2];

    let end = /*[[${endDate}]]*/;
    var splitEnd = end.split('-');
    let endDate = splitEnd[1] + '.' + splitEnd[2];

    document.querySelector('#date').innerText = startDate + '~' +endDate;
  /*]]>*/


  function goToBattlePage(element) {
    var battleCode = /*[[${battleCode}]]*/;
    window.location.href = '/calender/detail?battleCode=' + battleCode;
  }
</script>

</body>
</html>